# lab4

easyfs/vfs.rs：add_link：

首先，它获取文件系统的锁，并尝试在磁盘 inode 中找到 old_name 对应的 inode 编号。如果找不到，方法返回 -1。

如果找到了对应的 inode 编号，它会修改根 inode。首先，它计算新的目录项数量和大小，然后增加根 inode 的大小。接着，它创建一个新的目录项，并将这个目录项写入到根 inode 的末尾。

然后，它获取新链接的磁盘 inode 的位置，并创建一个新的 Inode 对象。这个对象的 block_id 和 block_offset 是新链接的磁盘 inode 的位置，fs 和 block_device 是从当前对象中复制过来的。

接着，它修改新链接的磁盘 inode，增加其引用计数。这是因为新链接和原链接都指向同一个 inode，所以 inode 的引用计数需要增加。

最后，它调用 block_cache_sync_all 方法，将所有的块缓存同步到磁盘，然后返回 0。这表示链接添加成功。

这个方法的主要用途是在文件系统中创建硬链接。硬链接是指向同一个 inode 的不同名字，它们在文件系统中看起来像是不同的文件，但实际上指向的是同一个文件。通过创建硬链接，可以在不复制文件内容的情况下，让文件在文件系统的不同位置出现。